<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>대리점 방문 지도</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=k8vacdhpym&submodules=geocoder"></script>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<!-- SheetJS for Excel -->
<script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

<style>
html, body { margin:0; padding:0; height:100%; font-family: 'Malgun Gothic', sans-serif; }
#map { width:100vw; height:100vh; }

#progress {
  position:absolute;
  top:10px;
  right:10px;
  z-index:1000;
  background:#fff;
  padding:10px 16px;
  border-radius:20px;
  font-weight:bold;
  box-shadow:0 2px 8px rgba(0,0,0,.2);
}

.action-btn {
  position:absolute;
  right:10px;
  z-index:1000;
  color:#fff;
  padding:10px 16px;
  border-radius:20px;
  font-weight:bold;
  box-shadow:0 2px 8px rgba(0,0,0,.2);
  cursor:pointer;
  border:none;
  font-size:14px;
  transition:.2s;
}

#download-btn {
  top:50px;
  background:#4caf50;
}

#download-btn:hover {
  background:#45a049;
}

#ai-analyze-btn {
  top:95px;
  background:#ff9800;
}

#ai-analyze-btn:hover {
  background:#f57c00;
}

#loading {
  position:absolute;
  top:140px;
  right:10px;
  z-index:1000;
  background:#2196f3;
  color:#fff;
  padding:8px 12px;
  border-radius:16px;
  font-size:12px;
  display:none;
}

/* 말풍선 - 번호만 (줌 아웃) */
.bubble-simple {
  position:relative;
  background:#fff;
  border:3px solid #d32f2f;
  border-radius:50%;
  padding:3px;
  font-size:9px;
  font-weight:bold;
  cursor:pointer;
  transition:.2s;
  min-width:16px;
  min-height:16px;
  display:flex;
  align-items:center;
  justify-content:center;
}

.bubble-simple.visited {
  border-color:#1976d2;
  background-color:#e3f2fd;
  color:#1976d2;
}

/* 말풍선 - 번호 + 이름 (줌 인) */
.bubble-full {
  position:relative;
  background:#fff;
  border:2px solid #d32f2f;
  border-radius:8px;
  padding:4px 10px;
  font-size:12px;
  font-weight:bold;
  white-space:nowrap;
  cursor:pointer;
  transition:.2s;
}

.bubble-full.visited {
  border-color:#1976d2;
  background-color:#e3f2fd;
  color:#1976d2;
}

.bubble-full:after {
  content:"";
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  bottom:-8px;
  width:0;
  height:0;
  border-left:6px solid transparent;
  border-right:6px solid transparent;
  border-top:8px solid #d32f2f;
}

.bubble-full.visited:after {
  border-top-color:#1976d2;
}

/* 모달 */
#modal, #ai-modal {
  display:none;
  position:fixed;
  top:0; left:0;
  width:100%; height:100%;
  background:rgba(0,0,0,0.5);
  z-index:2000;
  justify-content:center;
  align-items:center;
}

#modal.show, #ai-modal.show {
  display:flex;
}

#modal-content, #ai-modal-content {
  background:#fff;
  border-radius:12px;
  padding:24px;
  width:90%;
  max-width:400px;
  box-shadow:0 4px 20px rgba(0,0,0,.3);
  max-height:80vh;
  overflow-y:auto;
}

#ai-modal-content {
  max-width:700px;
}

#modal-title {
  font-size:18px;
  font-weight:bold;
  margin-bottom:16px;
  color:#333;
}

#ai-modal-title {
  font-size:18px;
  font-weight:bold;
  margin-bottom:16px;
  color:#333;
}

.modal-section {
  margin-bottom:16px;
}

.modal-section label {
  display:block;
  font-weight:bold;
  margin-bottom:8px;
  color:#555;
}

.status-buttons {
  display:flex;
  gap:8px;
}

.status-btn {
  flex:1;
  padding:10px;
  border:2px solid #ddd;
  background:#fff;
  border-radius:8px;
  cursor:pointer;
  font-weight:bold;
  transition:.2s;
}

.status-btn:hover {
  background:#f5f5f5;
}

.status-btn.active.visited {
  border-color:#1976d2;
  background:#1976d2;
  color:#fff;
}

.status-btn.active.not-visited {
  border-color:#d32f2f;
  background:#d32f2f;
  color:#fff;
}

#comment-input {
  width:100%;
  min-height:100px;
  padding:10px;
  border:2px solid #ddd;
  border-radius:8px;
  font-size:14px;
  resize:vertical;
  box-sizing:border-box;
  font-family:inherit;
}

#char-count {
  text-align:right;
  font-size:12px;
  color:#666;
  margin-top:4px;
}

.modal-buttons {
  display:flex;
  gap:8px;
  margin-top:20px;
}

.modal-btn {
  flex:1;
  padding:12px;
  border:none;
  border-radius:8px;
  font-weight:bold;
  cursor:pointer;
  font-size:14px;
  transition:.2s;
}

.modal-btn.save {
  background:#4caf50;
  color:#fff;
}

.modal-btn.save:hover {
  background:#45a049;
}

.modal-btn.cancel {
  background:#f5f5f5;
  color:#333;
}

.modal-btn.cancel:hover {
  background:#e0e0e0;
}

#ai-result {
  background:#f5f5f5;
  padding:16px;
  border-radius:8px;
  font-size:14px;
  line-height:1.6;
  white-space:pre-wrap;
  margin-top:16px;
}

.ai-loading {
  text-align:center;
  padding:40px;
  color:#666;
}

.ai-loading:after {
  content:'...';
  animation: dots 1.5s steps(4, end) infinite;
}

@keyframes dots {
  0%, 20% { content: '.'; }
  40% { content: '..'; }
  60%, 100% { content: '...'; }
}
/* ========== 여기서부터 복사 ========== */

/* AI 채팅 사이드바 */
#ai-sidebar {
  position: fixed;
  top: 0;
  right: -400px;
  width: 400px;
  height: 100vh;
  background: #fff;
  box-shadow: -2px 0 10px rgba(0,0,0,0.2);
  z-index: 3000;
  transition: right 0.3s ease;
  display: flex;
  flex-direction: column;
}

#ai-sidebar.open {
  right: 0;
}

#ai-sidebar-header {
  background: #667eea;
  color: #fff;
  padding: 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

#ai-sidebar-header h3 {
  margin: 0;
  font-size: 18px;
}

#close-sidebar {
  background: none;
  border: none;
  color: #fff;
  font-size: 24px;
  cursor: pointer;
  padding: 0;
  width: 30px;
  height: 30px;
}

#chat-messages {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
  background: #f5f5f5;
}

.chat-message {
  margin-bottom: 16px;
  display: flex;
  flex-direction: column;
}

.chat-message.user {
  align-items: flex-end;
}

.chat-message.ai {
  align-items: flex-start;
}

.message-bubble {
  max-width: 80%;
  padding: 12px 16px;
  border-radius: 16px;
  word-wrap: break-word;
  white-space: pre-wrap;
  line-height: 1.5;
}

.chat-message.user .message-bubble {
  background: #667eea;
  color: #fff;
  border-bottom-right-radius: 4px;
}

.chat-message.ai .message-bubble {
  background: #fff;
  color: #333;
  border-bottom-left-radius: 4px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

.message-time {
  font-size: 11px;
  color: #999;
  margin-top: 4px;
}

#chat-input-area {
  padding: 16px;
  background: #fff;
  border-top: 1px solid #e0e0e0;
}

#chat-input {
  width: 100%;
  min-height: 60px;
  max-height: 120px;
  padding: 12px;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 14px;
  font-family: inherit;
  resize: none;
  box-sizing: border-box;
  margin-bottom: 8px;
}

#chat-input:focus {
  outline: none;
  border-color: #667eea;
}

#send-chat-btn {
  width: 100%;
  padding: 12px;
  background: #667eea;
  color: #fff;
  border: none;
  border-radius: 8px;
  font-size: 14px;
  font-weight: bold;
  cursor: pointer;
  transition: .2s;
}

#send-chat-btn:hover {
  background: #5568d3;
}

#open-chat-btn {
  position: fixed;
  right: 10px;
  bottom: 20px;
  width: 60px;
  height: 60px;
  background: #667eea;
  color: #fff;
  border: none;
  border-radius: 50%;
  font-size: 28px;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  z-index: 2500;
  transition: .2s;
}

#open-chat-btn:hover {
  background: #5568d3;
  transform: scale(1.1);
}

/* ========== 여기까지 복사 ========== */
</style>
</head>

<body>

<div id="progress">완료율 0%</div>
<button id="download-btn" class="action-btn">📥 엑셀 다운로드</button>
<button id="ai-analyze-btn" class="action-btn">🤖 AI 분석</button>
<div id="loading">처리 중...</div>
<div id="map"></div>

<!-- 방문 정보 모달 -->
<div id="modal">
  <div id="modal-content">
    <div id="modal-title"></div>
    
    <div class="modal-section">
      <label>방문 상태</label>
      <div class="status-buttons">
        <button class="status-btn not-visited" data-status="false">미방문</button>
        <button class="status-btn visited" data-status="true">방문완료</button>
      </div>
    </div>
    
    <div class="modal-section">
      <label>코멘트 (500자 이내)</label>
      <textarea id="comment-input" maxlength="500" placeholder="방문 후기나 메모를 입력하세요..."></textarea>
      <div id="char-count">0/500</div>
    </div>
    
    <div class="modal-buttons">
      <button class="modal-btn cancel">취소</button>
      <button class="modal-btn save">저장</button>
    </div>
  </div>
</div>

<!-- AI 분석 모달 -->
<div id="ai-modal">
  <div id="ai-modal-content">
    <div id="ai-modal-title">🤖 AI 분석 결과</div>
    <div id="ai-result">
      <div class="ai-loading">AI가 데이터를 분석하고 있습니다</div>
    </div>
    <div class="modal-buttons">
      <button class="modal-btn cancel" onclick="closeAIModal()">닫기</button>
    </div>
  </div>
</div>
<!-- ========== 여기서부터 복사 ========== -->

<!-- AI 채팅 열기 버튼 -->
<button id="open-chat-btn">💬</button>

<!-- AI 채팅 사이드바 -->
<div id="ai-sidebar">
  <div id="ai-sidebar-header">
    <h3>🤖 AI 어시스턴트</h3>
    <button id="close-sidebar">×</button>
  </div>
  
  <div id="chat-messages">
    <div class="chat-message ai">
      <div class="message-bubble">
        안녕하세요! 대리점 방문 관리를 도와드립니다. 😊
        
        무엇을 도와드릴까요?
      </div>
      <div class="message-time">지금</div>
    </div>
  </div>
  
  <div id="chat-input-area">
    <textarea id="chat-input" placeholder="질문을 입력하세요..."></textarea>
    <button id="send-chat-btn">전송</button>
  </div>
</div>

<!-- ========== 여기까지 복사 ========== -->
<script>
// ============================================
// Firebase 설정
// ============================================
const firebaseConfig = {
  apiKey: "AIzaSyDjTcHpGJskJNkY-qLlU02A_yDe4fCZIaI",
  authDomain: "store-map-5cf8b.firebaseapp.com",
  projectId: "store-map-5cf8b",
  storageBucket: "store-map-5cf8b.firebasestorage.app",
  messagingSenderId: "805186031186",
  appId: "1:805186031186:web:694602e04ee9579189998b"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// ============================================
// Anthropic API 설정
// ============================================
const ANTHROPIC_API_KEY = "YOUR_ANTHROPIC_API_KEY"; // 여기에 API 키 입력!

// ============================================
// 매장 데이터 (385개)
// ============================================
const stores = [
{num:1,name:"상상대리점 도매사무실",address:"대구 중구 중앙대로 390 (동성로3가,센트럴엠빌딩) 12층"},
{num:2,name:"정원대리점 사무실",address:"서울 광진구 구의강변로 64, A동 202-1호(구의동,구의아크로리버)"},
{num:3,name:"성신대리점 하당점",address:"전남 목포시 통일대로 87 (옥암동)"},
{num:4,name:"장천대리점 여천점",address:"전남 여수시 망마로 42 (학동)"},
{num:5,name:"전북나은 효자1가점",address:"전북 전주시 완산구 효동2길 3, (효자동1가,1층T-WORLD)"},
{num:6,name:"제주정다운대리점 서사라점",address:"제주 제주시 서사로 87, (삼도이동,부산조방낙지) SK텔레콤 정다운 대리점 서사라점"},
{num:7,name:"서광대리점 춘의본점",address:"경기 부천시 부천로 227, (춘의동) (SK텔레콤 서광대리점 춘의본점)"},
{num:8,name:"CD대리점 도매사무실",address:"서울 광진구 천호대로 597 (중곡동,원택빌딩), 3층"},
{num:9,name:"CD대리점 구리역점",address:"경기 구리시 경춘로 229, 1층 105,106호 (인창동,구리쌍용타워)"},
{num:10,name:"PS&M (상동역점)",address:"경기 부천시 원미구 상동로 87 1층 109-1.2호(상동.가나베스트타운)"},
{num:11,name:"오아시스 강남역 개통사무실",address:"서울 강동구 천호옛길 70, 4층 (성내동,성덕빌딩)"},
{num:12,name:"제우스Biz(본점)",address:"대전 대덕구 한밭대로1033번길 38, (오정동)"},
{num:13,name:"유진대리점 도매사무실",address:"대구 중구 명덕로 189, (남산동)"},
{num:14,name:"Phone&Love텔레콤 화원직영점",address:"대구 달성군 화원읍 비슬로 2569-4 ()"},
{num:15,name:"상상대리점 신천직영점",address:"대구 동구 동부로 18-1, (신천동)"},
{num:16,name:"안동남부대리점 경북도청점",address:"경북 안동시 풍천면 갈전리 1276번지 중앙타워 111,112호"},
{num:17,name:"남부대리점 베스트직영점",address:"경북 구미시 구미중앙로 75, 124동 10호(원평동,동양빌딩)"},
{num:18,name:"파워셀대리점 김해점",address:"경남 김해시 가락로 63 (부원동,라세느)"},
{num:19,name:"렉스대리점 기장점",address:"부산 기장군 기장읍 차성로288번길 57, 1층 (예현빌딩)"},
{num:20,name:"명성대리점 반여점",address:"부산 해운대구 선수촌로 98, (반여동,경신빌딩) 경신빌딩"},
{num:21,name:"레이스대리점 명지직영점",address:"부산 강서구 명지오션시티4로 75, 1층 106호(명지동)"},
{num:22,name:"한백대리점 양산4호점",address:"경남 양산시 양산역6길 13 (중부동,메트로타워빌딩) 104호,105호"},
{num:23,name:"착한대리점 본점",address:"경남 창원시 의창구 도계로 58, 1층(도계동,SK텔레콤)"},
{num:24,name:"아이언대리점 캡틴점",address:"부산 사상구 가야대로255번길 5, 114동 105호(주례동,주례롯데캐슬골드스마트)"},
{num:25,name:"산청대리점 산청점",address:"경남 산청군 산청읍 웅석봉로 26 ()"},
{num:26,name:"티앤비대리점 대안본점",address:"경남 진주시 진양호로527번길 8, (대안동)"},
{num:27,name:"OK대리점 평거점",address:"경남 진주시 새들말로 34-4, 1층 101호(평거동,코앞맛집타운)"},
{num:28,name:"OK대리점 거제중앙점",address:"경남 거제시 거제중앙로 1844, 1층 101호(고현동)"},
{num:29,name:"남선대리점 풍암 프리미엄점",address:"광주 서구 풍암중앙로 53 (풍암동)"},
{num:30,name:"남선대리점 금호운천로점",address:"광주 서구 운천로 10-1, (금호동)"},
{num:31,name:"장천대리점 관리부/개통실",address:"전남 순천시 장명로 17, 6층 (장천동,서전빌딩)"},
{num:32,name:"장천대리점 연향프라자점",address:"전남 순천시 연향번영길 122 (연향동) 7,8호"},
{num:33,name:"봉화대리점 중마2호점",address:"전남 광양시 길호3길 1, 1동 1호(중마동)"},
{num:34,name:"나은대리점 구례1호점",address:"전남 구례군 구례읍 중앙로 38 ()"},
{num:35,name:"나은대리점 마동점",address:"전남 광양시 진등5길 16, (마동) SK텔레콤"},
{num:36,name:"대광대리점 개통실",address:"광주 서구 무진대로 764, 4층 (쌍촌동,광진빌딩)"},
{num:37,name:"한성대리점 나운2호점",address:"전북 군산시 신설로 2 (나운동) SK텔레콤"},
{num:38,name:"제주정다운대리점 본점",address:"제주 제주시 월랑로 33 (노형동,한라빌딩)"},
{num:39,name:"미래대리점 마장역직영점",address:"서울 성동구 마장로 284-1 (마장동,삼부약국)"},
{num:40,name:"준대리점 강동역본점",address:"서울 강동구 천호대로 1099, 104호 (천호동) 정산타워빌딩"},
{num:41,name:"백마장대리점 녹양직영점",address:"경기 의정부시 비우로 93 (녹양동)"},
{num:42,name:"참스타대리점 개통실",address:"인천 남동구 예술로204번길 35 (구월동)"},
{num:43,name:"별마루대리점 루원시티직영점(본점)",address:"인천 서구 염곡로498번안길 16-1, 1층 103호(가정동)"},
{num:44,name:"논현역대리점 본점",address:"서울 서초구 사평대로55길 149, (반포동)"},
{num:45,name:"모노대리점 중앙점",address:"경기 용인시 처인구 금령로 91 (김량장동)"},
{num:46,name:"모노대리점 안성점",address:"경기 안성시 중앙로 362 (석정동,SK텔레콤)"},
{num:47,name:"모노대리점 본점",address:"경기 용인시 처인구 백옥대로 1089, (김량장동) 1층"},
{num:48,name:"독산대리점 시흥직영점",address:"서울 금천구 시흥대로 233 (시흥동)"},
{num:49,name:"강서대리점 서판교점",address:"경기 성남시 분당구 운중로 128, 107호(운중동)"},
{num:50,name:"CD대리점 신도림역점",address:"서울 구로구 경인로 661, 102동 1층 102호 (신도림동,신도림1차푸르지오)"},
{num:51,name:"ACT대리점 원당본점",address:"인천 서구 원당대로 841 104~105호(원당동824-2,골든벨프라자)"},
{num:52,name:"유선대리점 약수역3번출구점",address:"서울 중구 다산로 132, 1층 2호(신당동)"},
{num:53,name:"온유대리점 개통사무실",address:"강원 원주시 서원대로 159 (단계동) 플러스빌딩 4층"},
{num:54,name:"펜타곤 YT점",address:"서울 용산구 한강대로7길 10-8, (한강로3가)"},
{num:55,name:"707(본점)",address:"서울 마포구 월드컵로 62, 5층 (서교동,한림빌딩)"},
{num:56,name:"디아이 본점(본점)",address:"경기 하남시 미사강변중앙로7번안길 25, 1011호 (풍산동,유테크밸리)"},
{num:57,name:"트렌드플래너 강남 개통사무실",address:"서울 강동구 천호옛길 70, 4층 (성내동,성덕빌딩)"},
{num:58,name:"AS1 본점(본점)",address:"경기 안산시 단원구 광덕대로 193, 404호 (고잔동,신양타운)"},
{num:59,name:"홍주대리점 본점",address:"충남 홍성군 홍성읍 조양로 137-1"},
{num:60,name:"맥스대리점 금천TPS점",address:"충북 청주시 상당구 중고개로 322, 103,105호(금천동,드림메디칼)"},
{num:61,name:"맥스대리점 두정직영점",address:"충남 천안시 서북구 오성2길 38, 1층 (두정동) 103, 104호"},
{num:62,name:"샤인정보(본점)",address:"인천 부평구 부평대로 165, 3층 (청천동,이오빌딩)"},
{num:63,name:"브레인아이씨티(본점)",address:"서울 송파구 법원로11길 11, A동 15층 1503호(문정동)"},
{num:64,name:"에스와이(본점)",address:"경남 창원시 의창구 창원대로 400, 2동 239호 (팔용동,창원기계공구상가)"},
{num:65,name:"상상앤이상(본점)",address:"충북 청주시 청원구 오창읍 중심상업로 14, 9층 906호"},
{num:66,name:"대구만평대리점 동천점",address:"대구 북구 대천로 93 (동천동)"},
{num:67,name:"대구가야대리점 도매사무실",address:"대구 달서구 달구벌대로 1670, 6층 (두류동,광산빌딩)"},
{num:68,name:"대구가야대리점 신암직영점",address:"대구 동구 아양로 50 (신암동)"},
{num:69,name:"대구가야대리점 내당점",address:"대구 서구 달구벌대로361길 1 1층 106호 N타워(내당동)"},
{num:70,name:"서부대리점 본점",address:"대구 서구 국채보상로 280, (평리동)"},
{num:71,name:"한미대리점 소매사무실",address:"대구 남구 대명로 165, (대명동) 1층"},
{num:72,name:"메트로대리점 현풍직영점",address:"대구 달성군 현풍면 현풍중앙로 22, 1동(베스타)"},
{num:73,name:"챌린저대리점 신서점",address:"대구 동구 경안로 848 101호(각산동)"},
{num:74,name:"프렌즈대리점 도매사무실",address:"대구 남구 성당로 70-1, (대명동) 2층"},
{num:75,name:"대구북구대리점 본점",address:"대구 북구 칠성남로 23 (고성동2가)"},
{num:76,name:"울진동부대리점 본점",address:"경북 울진군 울진읍 울진중앙로 137 ()"},
{num:77,name:"화금대리점 오거리직영점",address:"경북 포항시 북구 중흥로 341 (죽도동)"},
{num:78,name:"효성대리점 본점",address:"경북 포항시 북구 새천년대로 1045 (창포동)"},
{num:79,name:"SM대리점 The나눔 양덕점",address:"경북 포항시 북구 장량로189번길 11, (양덕동)"},
{num:80,name:"라온대리점 도매사무실(대구)",address:"대구 중구 봉산문화길 49, (봉산동) 봉성빌딩 3층"},
{num:81,name:"상상대리점 유천직영점",address:"대구 달서구 조암로 155, (대천동)"},
{num:82,name:"상상대리점 복현오거리점",address:"대구 북구 검단로 3 (산격동) 3, 1층 113호 (산격점,복현오거리)"},
{num:83,name:"한별대리점 비산본점",address:"대구 서구 달서로 154, (비산동,안주영베이커리)"},
{num:84,name:"대원대리점(본점)",address:"경북 포항시 남구 구룡포읍 호미로 209-1 ."},
{num:85,name:"안동남부대리점 의성직영점",address:"경북 의성군 의성읍 군청길 4, ()"},
{num:86,name:"남부대리점 1번가직영본점",address:"경북 구미시 구미중앙로 81 (원평동) 현대보석"},
{num:87,name:"남부대리점 김천점",address:"경북 김천시 시청로 79 (신음동)"},
{num:88,name:"왜관대리점 본점",address:"경북 칠곡군 왜관읍 중앙로 147 삼양 Y Y 빌딩"},
{num:89,name:"중앙SK대리점 옥동직영점",address:"경북 안동시 광명로 178 (옥동)"},
{num:90,name:"솔로몬대리점 방촌점",address:"대구 동구 동촌로 225, 1층 (방촌동,사랑빌딩)"},
{num:91,name:"솔로몬대리점 경산하양점",address:"경북 경산시 하양읍 대학로 1530, ()"},
{num:92,name:"SK매우만족대리점 본점",address:"경북 예천군 예천읍 시장로 144"},
{num:93,name:"안동삼성대리점 본점",address:"경북 안동시 경동로 519, (태화동) 경동로 521"},
{num:94,name:"티엔에스 진평점",address:"경북 구미시 인동북길 79 1층 103.104호(인의동.섬계빌딩)"},
{num:95,name:"드림라인 도매사무실",address:"대구 남구 대명로 101, 4층 (대명동)"},
{num:96,name:"한빛대리점 본점",address:"부산 사상구 사상로 161 (괘법동)"},
{num:97,name:"한빛_도매사무실",address:"부산 사상구 사상로 161, 5층 (괘법동)"},
{num:98,name:"렉스도매사무실",address:"부산 북구 금곡대로285번길 81 (화명동)"},
{num:99,name:"렉스대리점 김해점",address:"경남 김해시 함박로101번길 2 (외동,안뜨레빌딩)"},
{num:100,name:"렉스대리점 당감점",address:"부산 부산진구 당감로 47, (당감동)"},
{num:101,name:"신사직대리점 본점",address:"부산 동래구 석사로 4 (사직동) 사직사거리 스벅 맞은편"},
{num:102,name:"부곡대리점 본점",address:"부산 금정구 부곡로 88 (부곡동)"},
{num:103,name:"다울대리점 본점",address:"부산 사상구 백양대로 888, 1층 (모라동,금보빌딩)"},
{num:104,name:"명성대리점 마린점",address:"부산 해운대구 마린시티2로 33, 155호 해운대두산위브더제니스상가"},
{num:105,name:"명성대리점 소매사무실",address:"부산 해운대구 마린시티3로 1, 801호 (우동,썬프라자)"},
{num:106,name:"명성대리점 해운대점",address:"부산 해운대구 좌동순환로 181, (좌동,진성빌딩) 해운대구 좌동순환로 181(진성빌딩)"},
{num:107,name:"스토리대리점 본점",address:"부산 남구 분포로 113, 1동 1호(용호동,엘지메트로시티아파트) 엘지메트로시티주2상가 1005-109"},
{num:108,name:"카이저_개금직영점",address:"부산 부산진구 가야대로 474, 1층 (개금동,개금동메디칼센터) SKT T world 카이저 개금점"},
{num:109,name:"해운대대리점 본점",address:"부산 해운대구 중동1로 4, 102호 (우동,동춘빌딩)"},
{num:110,name:"예스 도매사무실",address:"부산 사상구 새벽로 195, 2층 (괘법동)"},
{num:111,name:"예스 괴정점",address:"부산 사하구 낙동대로 332 (괴정동,희망빌딩)"},
{num:112,name:"예스 화명2호점",address:"부산 북구 화명대로 27 (화명동 윤플라자 1층)"},
{num:113,name:"예스 삼계점",address:"경남 김해시 삼계중앙로 36, 101호 (삼계동)"},
{num:114,name:"영일대리점 동삼점",address:"부산 영도구 동삼로 61 (동삼동)"},
{num:115,name:"영일대리점 서창점",address:"경남 양산시 신명동7길 56, (명동)"},
{num:116,name:"KB대리점_도매사무실",address:"울산 남구 중앙로 167 (신정동)"},
{num:117,name:"티엔대리점 본점",address:"부산 부산진구 동천로 95 (부전동)"},
{num:118,name:"티엔대리점 부산대점",address:"부산 금정구 장전온천천로 45, 1층 (장전동)"},
{num:119,name:"성우대리점 김해직영점",address:"경남 김해시 인제로 174 (어방동)"},
{num:120,name:"금호대리점 남창점",address:"울산 울주군 온양읍 온양로 95, ()"},
{num:121,name:"정성대리점 충무교차로점",address:"부산 서구 충무대로 285 (충무동1가)"},
{num:122,name:"정성대리점 양정역점",address:"부산 부산진구 중앙대로 920, 1층 (양정동,대한설비건설공제조합)"},
{num:123,name:"정성대리점 신안평거점",address:"경남 진주시 진양호로 267, 1층 (신안동)"},
{num:124,name:"동원대리점 부원점",address:"경남 김해시 호계로438번길 10 (부원동,해강오피스텔)"},
{num:125,name:"동원대리점 도매사무실",address:"부산 사상구 백양대로 956 (모라동)"},
{num:126,name:"밀양대리점 본점",address:"경남 밀양시 중앙로 374 (내일동,SK텔레콤)"},
{num:127,name:"우일대리점 고성본점",address:"경남 고성군 고성읍 동외로156번길 5-3, SK텔레콤"},
{num:128,name:"우일대리점 마산시청점",address:"경남 창원시 마산합포구 3.15대로 204-1 (중앙동2가)"},
{num:129,name:"한백대리점 동아대점",address:"부산 사하구 낙동대로 522 (하단동,태아연립)"},
{num:130,name:"한백대리점 창원점",address:"경남 창원시 성산구 마디미로 23, (상남동,CNB빌딩) 102호"},
{num:131,name:"한백대리점 덕천TPS",address:"부산 북구 만덕대로27번길 3, 101동 (덕천동) (덕천동,대흥빌딩)"},
{num:132,name:"착한대리점 석동점",address:"경남 창원시 진해구 냉천로 87 (석동) Y-ZONE빌딩(와이존빌딩) 101호"},
{num:133,name:"착한대리점 신촌점",address:"경남 창원시 성산구 신촌로 83, 가동 104호(신촌동,양곡상가아파트상가)"},
{num:134,name:"TS대리점 반여점",address:"부산 해운대구 재반로 216, 1층 (반여동)"},
{num:135,name:"TS대리점 남부시장점",address:"경남 양산시 중앙로 130, (남부동,상우빌딩)"},
{num:136,name:"서진주대리점 강남점",address:"경남 진주시 망경로 269 (망경동)"},
{num:137,name:"산청대리점 원지본점",address:"경남 산청군 신안면 지리산대로 3474 ()"},
{num:138,name:"우리통영대리점 유빈점",address:"경남 통영시 광도면 죽림2로 75 ()"},
{num:139,name:"우리통영대리점 주영점",address:"경남 통영시 광도면 죽림3로 23-57, 109호(다임솔카운티아파트)"},
{num:140,name:"티앤비대리점 금산본점",address:"경남 진주시 금산면 금산순환로 9, 1층 103호(세종빌딩)"},
{num:141,name:"미소대리점_도매사무실",address:"경남 진주시 동부로169번길 12, B동 1207호 (충무공동,윙스타워)"},
{num:142,name:"미소대리점 고현플러스점",address:"경남 거제시 서문로 71, (고현동)"},
{num:143,name:"미소대리점 촉석점",address:"경남 진주시 진주대로 1160, (봉곡동)"},
{num:144,name:"OK대리점 무전점",address:"경남 통영시 중앙로 303-5 (북신동,화룡빌딩)"},
{num:145,name:"OK대리점 삼천포점",address:"경남 사천시 주공로 44 (벌리동,하이카프라자)"},
{num:146,name:"OK대리점 옥포오션점",address:"경남 거제시 옥포성안로 38-1 (옥포동)"},
{num:147,name:"파랑새대리점 본점",address:"부산 수영구 광일로 26, 1층 (광안동)"},
{num:148,name:"광주인천상사대리점 도매개통실",address:"광주 북구 경열로 219 (유동)"},
{num:149,name:"광주인천상사대리점 화정점",address:"광주 서구 상무대로 1046, (화정동)"},
{num:150,name:"전남서해대리점 목포지사",address:"전남 목포시 비파로 123-1 (상동,도산서원) 2층"},
{num:151,name:"전남서해대리점 오룡본점",address:"전남 무안군 일로읍 오룡번영3로 40, 106호,107호"},
{num:152,name:"남선대리점 개통실",address:"광주 동구 남문로621번길 1, 3층 (용산동) 남선빌딩 3층"},
{num:153,name:"남선대리점 학동점",address:"광주 동구 남문로 699, (학동,가승전기빌딩)"},
{num:154,name:"우성대리점 본점",address:"전남 목포시 옥암로 82 (옥암동)"},
{num:155,name:"태경대리점 진도점",address:"전남 진도군 진도읍 남동1길 40-4 (SK텔레콤)"},
{num:156,name:"무등대리점 두암점",address:"광주 북구 동문대로 158 (두암동)"},
{num:157,name:"무안대리점 본점",address:"전남 무안군 무안읍 무안중앙로 9 ()"},
{num:158,name:"엠코리아대리점 쌍촌점",address:"광주 서구 화정로 134-1 (화정동)"},
{num:159,name:"다린컴즈대리점 염주점",address:"광주 서구 월드컵4강로 30, 1층(화정동,만호빌딩)"},
{num:160,name:"장천대리점 신대점",address:"전남 순천시 해룡면 신대로 117 ()"},
{num:161,name:"봉화대리점 연향1호점",address:"전남 순천시 연향중앙상가길 12, 1층 (연향동) SKT 봉화대리점 연향1호점"},
{num:162,name:"광주서림대리점 임동점",address:"광주 북구 서림로 104-2, (임동)"},
{num:163,name:"나은대리점 중마점",address:"전남 광양시 중마중앙로 61 (중동) SK텔레콤 나은대리점중마점"},
{num:164,name:"나은대리점 중동 시청점",address:"전남 광양시 중마중앙로 112 (중동)"},
{num:165,name:"나은대리점 개통실",address:"전남 광양시 광양읍 신재로 73-1 ()"},
{num:166,name:"나은대리점 무등점",address:"전남 광양시 중마로 229, 1층 (중동)"},
{num:167,name:"나은대리점 신대점",address:"전남 순천시 해룡면 신대로 2, 1층 (백운빌딩) 103호"},
{num:168,name:"나은대리점 국동점",address:"전남 여수시 어항로 1, (봉산동) 1층"},
{num:169,name:"고흥대리점 고흥본점",address:"전남 고흥군 고흥읍 봉황길 21-1, ()"},
{num:170,name:"우리대리점 중앙점",address:"전남 여수시 중앙로 50-1, (교동,행남자기)"},
{num:171,name:"스카이대리점 봉선점",address:"광주 남구 봉선중앙로 83 (봉선동)"},
{num:172,name:"스카이대리점 운남점",address:"광주 광산구 목련로273번안길 19, (운남동)"},
{num:173,name:"도움대리점 본점",address:"전남 여수시 덕양로 156, (화장동,SK텔레콤)"},
{num:174,name:"럭키대리점 본점",address:"전남 여수시 동문로 5 (중앙동)"},
{num:175,name:"가온대리점 본점(본점)",address:"광주 광산구 손재로110번길 32, 1층 (산정동)"},
{num:176,name:"전북경원대리점 본점",address:"전북 전주시 완산구 팔달로 214 (경원동3가)"},
{num:177,name:"중앙대리점 개통센터",address:"전북 익산시 중앙로 118 (마동,사또뼈다구탕)"},
{num:178,name:"군산진포대리점 군산대점",address:"전북 군산시 대학로 553 (미룡동)"},
{num:179,name:"중부대리점 개통센터",address:"전북 전주시 덕진구 호성3길 22, 4층 (호성동1가,태화빌딩)"},
{num:180,name:"중부대리점 에코시티점",address:"전북 전주시 덕진구 세병남로 31, 101호 (송천동2가)"},
{num:181,name:"한성대리점 개통센터",address:"전라북도 군산시 수송로 133번지 2층 한성텔레콤"},
{num:182,name:"한성대리점 최강점",address:"전북 익산시 궁동로 124 (부송동,춘영빌딩)"},
{num:183,name:"더 대리점 개통실",address:"전북 전주시 덕진구 송천중앙로 167 (송천동1가,대국빌딩)"},
{num:184,name:"서정대리점 아중점",address:"전북 전주시 덕진구 무삼지로 87 (인후동1가,태산)"},
{num:185,name:"전북나은대리점 김제점",address:"전북 김제시 금성로 111, (검산동)"},
{num:186,name:"전북나은 중화산점",address:"전북 전주시 완산구 서원로 304, (중화산동2가)"},
{num:187,name:"고객행복대리점 신시가지점",address:"전북 전주시 완산구 홍산남로 45, 101호(효자동3가,전주일준빌딩)"},
{num:188,name:"동양통신 진북태평점",address:"전북 전주시 덕진구 태진로 91, (진북동)"},
{num:189,name:"바른대리점 상동점",address:"전북 정읍시 충정로 80, (상동, SK텔레콤)"},
{num:190,name:"바른대리점 전주대점",address:"전북 전주시 완산구 우전로 212, 101호(효자동2가)"},
{num:191,name:"제주광양대리점 아라점",address:"제주 제주시 중앙로 388, 1층 (이도이동) 3,4호"},
{num:192,name:"제주광양대리점 삼화점",address:"제주 제주시 화북일동 1994-8번지"},
{num:193,name:"제주E&T대리점 도매개통실",address:"제주 제주시 이도2동 235 양암빌딩 5층"},
{num:194,name:"제주E&T대리점 연북로점",address:"제주 제주시 연북로 34 (노형동,노성빌딩)"},
{num:195,name:"제주E&T대리점 삼화점",address:"제주 제주시 화삼북로 68, 1동 101호 (도련일동) 1층"},
{num:196,name:"제주E&T대리점 노형점",address:"제주 제주시 노형로 362, (노형동)"},
{num:197,name:"스마일대리점 남녕점",address:"제주 제주시 남녕로 45, 101호 (노형동,덕진연립주택)"},
{num:198,name:"미래대리점 동탄호수직영점",address:"경기 화성시 동탄대로 181, A동 131호(송동,동탄린스트라우스더레이크)"},
{num:199,name:"미래대리점 동탄직영점",address:"경기 화성시 동탄순환대로 263 (산척동)"},
{num:200,name:"미래대리점 산본직영점",address:"경기 군포시 산본로323번길 16-30, 1층 103,104,105호 (산본동,성보프라자)"},
{num:201,name:"여주여흥대리점 홍문점",address:"경기 여주시 세종로 27-1, (홍문동)"},
{num:202,name:"세화대리점 장자호수역점",address:"경기 구리시 장자대로 78, 1층 (수택동,연성클리닉센터빌딩)"},
{num:203,name:"곤지암대리점 본점",address:"경기 광주시 곤지암읍 곤지암로 35 ()"},
{num:204,name:"곤지암대리점 초월점",address:"경기 광주시 초월읍 경충대로 1252 ()"},
{num:205,name:"이천중앙대리점 분수대점",address:"경기 이천시 이섭대천로 1232 (창전동,삼우보청기)"},
{num:206,name:"영진대리점 본점",address:"경기 이천시 이섭대천로 1242 (창전동) 정곤빌딩 1층 SK텔레콤"},
{num:207,name:"서울ent대리점 개통실",address:"서울 강동구 강동대로53길 31, 2층 (성내동)"},
{num:208,name:"서울ent대리점 유선개통실",address:"서울 강동구 강동대로53길 31, 2층(성내동,서울E&T)"},
{num:209,name:"서울ent대리점 도림직영점",address:"서울 영등포구 도영로 27, (도림동)"},
{num:210,name:"서울ent대리점 상계역점",address:"서울 노원구 한글비석로 384, 1동 187호(중계동) 187~188호"},
{num:211,name:"이천대리점 문화의거리점",address:"경기 이천시 이섭대천로1217번길 4, 101동 102호(창전동)"},
{num:212,name:"늘푸른대리점 한성대역점",address:"서울 성북구 동소문로 17 (동소문동1가 화보빌딩 1층"},
{num:213,name:"정원대리점 보정직영점",address:"경기 용인시 기흥구 죽전로 29, 1층 107호 (보정동,포레스트빌딩) (107호,108호)"},
{num:214,name:"정원대리점 위례광장직영점",address:"경기 성남시 수정구 위례광장로 320, 1층 107호, 108호(창곡동,아이에스센트럴타워)"},
{num:215,name:"정원대리점 위례학암동직영점",address:"경기 하남시 위례학암로14번길 27, 1층 101호(학암동) 디에이치타워위례"},
{num:216,name:"신나는 마곡직영점",address:"서울 강서구 공항대로 168, 113, 114, 115호(마곡동)"},
{num:217,name:"신도SDR (도매사무실)",address:"서울 강남구 테헤란로88길 14 (대치동,신도빌딩)"},
{num:218,name:"신도SDR대리점 삼성역 본점",address:"서울 강남구 테헤란로88길 14 (대치동,신도에스디알) 1층 SK텔레콤"},
{num:219,name:"UNI대리점 학익직영점",address:"인천 미추홀구 한나루로 400 (학익동, 학익시장)"},
{num:220,name:"부개대리점 청라지젤엠점",address:"인천 서구 청라에메랄드로 99, 101호(청라동)"},
{num:221,name:"백마장대리점 검단점",address:"인천 서구 원당대로 663, 1동 102호 (마전동)"},
{num:222,name:"백마장대리점 청천직영점",address:"인천 부평구 마장로 489, 3동 1층 10호 (청천동,아이즈빌아울렛)"},
{num:223,name:"인천도원대리점 본점",address:"인천 부평구 부평대로 139 (부평동)"},
{num:224,name:"인천도원대리점 주안역직영점",address:"인천 미추홀구 석정로 396 (주안동) SK텔레콤"},
{num:225,name:"화산대리점 임학역점",address:"인천 계양구 장제로 881 (임학동)"},
{num:226,name:"화산대리점 계양중앙점",address:"인천 계양구 계산새로 71, C동 1층 108, 109호(계산동,하이베라스빌딩)"},
{num:227,name:"참스타대리점 블루나인점",address:"서울 강서구 양천로 583, A동 101호 (염창동,우림블루나인)"},
{num:228,name:"참스타대리점 신월점",address:"서울 양천구 남부순환로 585, 101호(신월동,유림웰스빌)"},
{num:229,name:"참스타대리점 교남점",address:"서울 종로구 송월길 99, 201동 1105호(홍파동,경희궁자이2단지) SK텔레콤"},
{num:230,name:"창도 도매사무실",address:"경기 남양주시 경춘로 508-4, 1동 7층 725호 (다산동,더리더스타워)"},
{num:231,name:"미소대리점 본점",address:"경기 안산시 단원구 광덕대로 174, 120호 (고잔동)"},
{num:232,name:"미소대리점 와동공원점",address:"경기 안산시 단원구 선부로 233, (와동) 1층"},
{num:233,name:"별마루대리점 신기사거리점",address:"인천 미추홀구 남주길 150, 상가동 113호(주안동,힐스테이트푸르지오주안) 푸르지오 상가 1층 113호"},
{num:234,name:"어프레쉬대리점 독산점(본점)",address:"서울 금천구 시흥대로138길 19, 1층 (독산동)"},
{num:235,name:"큰사랑대리점 도곡점",address:"서울 강남구 언주로30길 21, A동 B101-8호,34호 (도곡동,아카데미스위트상가)"},
{num:236,name:"코넥대리점 신봉직영점",address:"경기 용인시 수지구 신봉2로 6 (신봉동,신원빌딩) 2층 203호, 204호"},
{num:237,name:"코넥대리점 인계 도매사무실",address:"경기 수원시 팔달구 인계로94번길 32 (인계동) 정진빌딩 4층 SKT"},
{num:238,name:"삼보대리점 본점(도매사무실)",address:"경기 평택시 중앙로 136 (합정동)"},
{num:239,name:"한유대리점 도매사무실",address:"서울 성동구 아차산로 33, (성수동1가,삼일빌딩) 7층 한유넥스텔"},
{num:240,name:"한유대리점 역촌점",address:"서울 은평구 연서로 75 (역촌동)"},
{num:241,name:"한유대리점 수서역점",address:"서울 강남구 광평로51길 8, (수서동,로얄프라자빌딩)"},
{num:242,name:"한유대리점 다산점",address:"경기 남양주시 다산중앙로123번길 22-30, 126, 127호 (다산동,다산헤리움그랑비스타2차)"},
{num:243,name:"한유대리점 목동광장직영점",address:"서울 양천구 목동동로 379, 106호(목동)"},
{num:244,name:"새서울대리점(본점)",address:"서울 강남구 압구정로 154 2층,(신사동)"},
{num:245,name:"새서울대리점 광명4거리점",address:"경기 광명시 오리로 936 (광명동,연세어학원)"},
{num:246,name:"강남스타대리점 본점",address:"서울 강남구 선릉로 640 (삼성동)"},
{num:247,name:"강남스타대리점 개포일원점",address:"서울 강남구 일원로 41, (일원동)"},
{num:248,name:"강남스타대리점 도매사무실",address:"서울 강남구 선릉로 640, 1층 (삼성동)"},
{num:249,name:"모바일대리점 본점",address:"경기 수원시 권선구 정조로 564 (세류동)"},
{num:250,name:"모노대리점 명지대점",address:"경기 용인시 처인구 명지로60번길 8-14, 106호 (역북동,H타워)"},
{num:251,name:"안성중앙대리점 본점",address:"경기 안성시 안성맞춤대로 1052-1 (서인동)"},
{num:252,name:"제이스대리점 야당직영점",address:"경기 파주시 경의로 1046, 1호 (야당동,이더펠리체) 108호, 109호"},
{num:253,name:"투마이스대리점 본점",address:"경기 군포시 광정로 68 (산본동,시네마타운) 104,105호"},
{num:254,name:"하나컴대리점 망포직영점",address:"경기 수원시 영통구 영통로 120, 1층 4호 (망포동,효성빌딩)"},
{num:255,name:"에스알 소매사무실",address:"서울 송파구 법원로8길 7, 706호(문정동)"},
{num:256,name:"에스알대리점 신월직영점",address:"서울 양천구 지양로 74, 6호(신월동,남영상가)"},
{num:257,name:"에스알대리점 태평본점",address:"경기 성남시 수정구 수정로 97 (태평동)"},
{num:258,name:"아리온 암사점",address:"서울 강동구 상암로 47, (암사동,암사빌딩)"},
{num:259,name:"지상대리점 보정점",address:"경기 용인시 기흥구 죽전로 47, (보정동) 107호(보정동,성진웰빙타운빌딩)"},
{num:260,name:"구로서부대리점 본점",address:"서울 구로구 구로동로 82 (구로동)"},
{num:261,name:"지은대리점 가산 도매 사무실",address:"서울 금천구 벚꽃로 234, 1동 312호(가산동, 에이스하이엔드타워6)"},
{num:262,name:"지은대리점 송산그린시티점",address:"경기 화성시 수노을중앙로 126, 1동 1층 103호(새솔동) 송산 나이스 프라자"},
{num:263,name:"도일대리점 본점",address:"서울 강서구 양천로 556, 102호 (등촌동,메디칼빌딩)"},
{num:264,name:"대교대리점 대교(본사)",address:"경기 안양시 만안구 안양로 234 (안양동)"},
{num:265,name:"대교대리점 평촌역점",address:"경기 안양시 동안구 관평로170번길 33 (관양동, 주공공이)"},
{num:266,name:"대교대리점 스마트직영점",address:"경기 안양시 동안구 시민대로 311, 122호 (관양동,금강스마트빌딩)"},
{num:267,name:"대교대리점 덕천직영점",address:"경기 안양시 만안구 태평로52번길 48, 1동 101호(안양동)"},
{num:268,name:"유통상가대리점 본점",address:"서울 영등포구 영등포로 131, 102호 (당산동1가,나열)"},
{num:269,name:"염창대리점 본점",address:"서울 강서구 양천로 706, 101호 (염창동,태진가람상가)"},
{num:270,name:"상록수대리점 우장산역직영점",address:"서울 강서구 강서로 254, 112호 (화곡동,우장산E-편한세상상가) 113호"},
{num:271,name:"상록수대리점 우장산점",address:"서울 강서구 강서로 242, 101호 (화곡동,강서힐스테이트상가) SK텔레콤 Tworld"},
{num:272,name:"백두대간대리점 본점",address:"서울 강서구 양천로 86 (방화동)"},
{num:273,name:"백두대간대리점 목동직영점",address:"서울 양천구 목동서로 349, 116호(신정동)"},
{num:274,name:"유원대리점 도매사무실",address:"서울 영등포구 선유로49길 23 (양평동4가,IS비즈) 706호"},
{num:275,name:"동진대리점 강서중앙점",address:"서울 강서구 강서로 279 (내발산동,대운진리회) 1층 SK텔레콤"},
{num:276,name:"근흥대리점 거모직영점",address:"경기 시흥시 한우물로 1, 103호(거모동,세븐일레븐) SK텔레콤 산본직영 거모점"},
{num:277,name:"서울대리점 평내호평직영점",address:"경기 남양주시 늘을2로14번길 3 (호평동) 에이스 프라자 106호"},
{num:278,name:"서울대리점 김포구래직영점",address:"경기 김포시 솔터로 22, 6886-4동 124호(구래동,메트로타워예미지)"},
{num:279,name:"세하 소하점",address:"경기 광명시 소하로 86, 107호 (소하동,제일프라자)"},
{num:280,name:"새샘대리점 영등포구청역 본점",address:"서울 영등포구 당산로 83, 1동 103호(당산동2가,한화포레나당산)"},
{num:281,name:"서울신당대리점 신설동역점",address:"서울 동대문구 천호대로 14 (신설동) 아세아빌딩 1층"},
{num:282,name:"광장대리점 도매사무실",address:"서울 광진구 면목로 160 (중곡동,경일빌딩)"},
{num:283,name:"광장대리점 광교월드마크점",address:"경기 수원시 영통구 센트럴타운로 107, 204동 52호(이의동,광교푸르지오월드마크,월드스퀘어)"},
{num:284,name:"MD대리점 광명철산직영점",address:"경기 광명시 철산로30번길 9 (철산동,광명프라자) 1층 101호"},
{num:285,name:"MD대리점 파주목동점",address:"경기 파주시 청암로17번길 31 (목동동) 108호"},
{num:286,name:"울림터대리점 본점",address:"서울 광진구 아차산로 220, 1층 (자양동,송천빌딩)"},
{num:287,name:"울림터대리점 합정역메세나점",address:"서울 마포구 양화로 45, 지하1층 (서교동,메세나폴리스) 비184, 비185호"},
{num:288,name:"유니쿱대리점 본점 (코드 Only)",address:"서울 종로구 성균관로 15 (명륜2가)"},
{num:289,name:"알리바바 도매사무실",address:"서울 광진구 천호대로143길 23 (광장동)"},
{num:290,name:"범교대리점 증산점",address:"서울 은평구 수색로 195, (증산동,두빌빌딩) SK텔레콤"},
{num:291,name:"프리스비(도매개통실)",address:"서울 용산구 한강대로 283-8, 2층 (갈월동)"},
{num:292,name:"프리스비 약수점",address:"서울 중구 동호로 180, (신당동,동양빌딩)"},
{num:293,name:"Orange 소매사무실",address:"서울 중구 명동3길 6, 16층 1601호(명동1가,개양빌딩)"},
{num:294,name:"신드롬대리점 구산직영점",address:"서울 은평구 서오릉로 173, 1층 (구산동)"},
{num:295,name:"연우대리점 화곡 대림점",address:"서울 강서구 월정로 160, 102호 (화곡동,대림아파트)"},
{num:296,name:"가능대리점 도매사무실",address:"경기 의정부시 시민로 57, 4층 (의정부동,동원빌딩)"},
{num:297,name:"ACT대리점 신시가지점",address:"경기 의정부시 신흥로 243, 1층 (의정부동,서영빌딩서관)"},
{num:298,name:"ACT대리점 (재고관리실)",address:"경기 의정부시 금오로 118 (금오동,금성빌딩) 2층 3층"},
{num:299,name:"ACT대리점 선유점",address:"경기 파주시 문산읍 사임당로 116 ()"},
{num:300,name:"ACT대리점 남양동점",address:"경기 화성시 남양읍 남양성지로 121, (동부화재) SK텔레콤"},
{num:301,name:"ACT대리점 양촌점",address:"경기 김포시 양촌읍 양곡2로30번길 7-7 1층"},
{num:302,name:"ACT대리점 상리점",address:"경기 화성시 봉담읍 샘마을길 45 ()"},
{num:303,name:"ACT대리점 인창동점",address:"경기 구리시 동구릉로85번길 9 (인창동703,동원베네스트상가 101호)"},
{num:304,name:"ACT대리점 풍무본점",address:"경기 김포시 풍무동 384번지 386-3 외 2필지"},
{num:305,name:"ACT대리점 광교본점",address:"경기 용인시 수지구 광교중앙로295번길 3, 108~110호(상현동1118,광교유타워)"},
{num:306,name:"ACT대리점 법원본점",address:"경기 파주시 법원읍 사임당로 831, 1동 1호(돌마통신)"},
{num:307,name:"ACT대리점 의정부도매사무실",address:"경기 의정부시 천보로 257, 2층 (금오동) ACT빌딩"},
{num:308,name:"ACT대리점 덕정본점",address:"경기 양주시 독바위로 20, (덕정동)"},
{num:309,name:"신창대리점 도매사무실",address:"서울 도봉구 덕릉로 248-1 (창동,대성빌딩) 2층, 4층"},
{num:310,name:"정릉대리점 보국문역점",address:"서울 성북구 보국문로 81 (정릉동)"},
{num:311,name:"알파대리점 석계역점",address:"서울 노원구 석계로 4, 101호(월계동,석계빌딩)"},
{num:312,name:"알파대리점 길음뉴타운점",address:"서울 성북구 길음로 33, B동 18호(길음동,길음뉴타운)"},
{num:313,name:"피앤씨홀딩스 의정부직영점",address:"경기 의정부시 호국로1298번길 63, (의정부동,라데팡스)"},
{num:314,name:"피앤씨홀딩스 이태원점",address:"서울 용산구 이태원로 187, (이태원동)"},
{num:315,name:"피앤씨홀딩스 상봉점",address:"서울 중랑구 용마산로115길 127, 101동 1004호(망우동,한일써너스빌리젠시1단지)"},
{num:316,name:"피앤씨홀딩스 삼양본점",address:"서울 강북구 삼양로 237, (미아동) 1층 SK텔레콤 삼양역 2번 → 200m"},
{num:317,name:"피앤씨홀딩스 낙양본점",address:"경기 의정부시 용민로 401, 1층 104, 105호호(낙양동) SK텔레콤"},
{num:318,name:"ACE대리점 도매사무실",address:"서울 성북구 화랑로 248, 704호(석관동,장위뉴타워)"},
{num:319,name:"늘봄대리점 강동구청역점",address:"서울 강동구 성내로 6, (성내동)"},
{num:320,name:"T SHOP대리점 강남8호점",address:"강원 춘천시 영서로2279번길 3, (온의동) 퐁당디저트"},
{num:321,name:"온유대리점 본점",address:"강원 원주시 서원대로 159, 1층 (단계동)"},
{num:322,name:"온유대리점 진부직영점",address:"강원 평창군 진부면 진부중앙로 64, 1층"},
{num:323,name:"춘천대리점 홍천직영점",address:"강원 홍천군 홍천읍 꽃뫼로 90, 1호"},
{num:324,name:"(주)KSK대리점 장원점",address:"충북 제천시 풍양로15길 8, (중앙로1가,풀햄제천점)"},
{num:325,name:"SK피에스앤마케팅_비즈(특수3)",address:"서울 성동구 아차산로 38 (성수동1가,개풍빌딩) 2층 B2B팀"},
{num:326,name:"PS&M (기흥점)",address:"경기 용인시 기흥구 관곡로64번길 18 (구갈동,모닝프라자) 102, 103호"},
{num:327,name:"PS&M (신도림점)",address:"서울 구로구 경인로 661, 1층 112호 (신도림동,신도림1차푸르지오)"},
{num:328,name:"PS&M (구로점)",address:"서울 구로구 도림로 73, 1층 (구로동,인성빌딩)"},
{num:329,name:"PS&M (서창지구점)",address:"인천 남동구 서창남순환로 222, 105호(서창동,센타프라자)"},
{num:330,name:"PS&M (곡반점)",address:"경기 수원시 권선구 동수원로146번길 6-3 (곡반정동) 101호 102호"},
{num:331,name:"PS&M (배곧신도시점)",address:"경기 시흥시 배곧3로 96, 122호 (정왕동,M플러스)"},
{num:332,name:"PS&M (수유점)",address:"서울 강북구 도봉로 353, 1층 (수유동,상목빌딩)"},
{num:333,name:"PS&M (중화역점)",address:"서울 중랑구 동일로 801 (중화동,상가)"},
{num:334,name:"PS&M (성신여대점)",address:"서울 성북구 아리랑로 10 (동선동4가,동신여관)"},
{num:335,name:"PS&M (식사점)",address:"경기 고양시 일산동구 위시티2로11번길 11, 상가동 129호 (식사동,휴먼빌일산위시티)"},
{num:336,name:"PS&M (일산본점)",address:"경기 고양시 일산동구 정발산로 24, A동 132호(장항동,웨스턴돔1) 167호"},
{num:337,name:"PS&M (화정점)",address:"울산 동구 대학길 83 (화정동) 미스터세븐"},
{num:338,name:"PS&M (봉곡점)",address:"경북 구미시 봉곡남로 76 (봉곡동)"},
{num:339,name:"PS&M (개금점)",address:"부산 부산진구 냉정로 226, 1층(개금동,금산빌딩)"},
{num:340,name:"PS&M (명지점)",address:"부산 강서구 명지국제8로 251 (명지동) 명지국제타워1동 1층 109호"},
{num:341,name:"PS&M (김해내동점)",address:"경남 김해시 내외중앙로 81, 103호 (내동,동화선프라자)"},
{num:342,name:"PS&M (신기점)",address:"전남 여수시 새터로 64 (신기동)"},
{num:343,name:"PS&M (제주연동점)",address:"제주 제주시 도령로 113 (연동) SK텔레콤 제주사옥"},
{num:344,name:"PS&M (대천점)",address:"충남 보령시 중앙로 87 (대천동) 동방체육사파크랜드"},
{num:345,name:"PS&M (제주중문점)",address:"제주 서귀포시 천제연로 194, (중문동)"},
{num:346,name:"PS&M (둔산본점)",address:"대전 서구 둔산로 125 (둔산동.스타타워)"},
{num:347,name:"PS&M (원주점)",address:"강원 원주시 남원로534번길 16 1층 SK텔레콤"},
{num:348,name:"PS&M (아산온천점)",address:"충남 아산시 충무로 22, 1층 (온천동,아산UL시티)"},
{num:349,name:"PS&M (여수중앙점)",address:"전남 여수시 중앙로 37, 1층 (충무동) 충무동 624-4"},
{num:350,name:"PS&M (서부5)",address:"강원 원주시 무실동 1718-1번지 메트로프라자"},
{num:351,name:"Dragon(본점)",address:"경기 성남시 중원구 갈마치로288번길 14, 101동 14층 1413호 (상대원동,성남SKV1타워) 1414호"},
{num:352,name:"골드(일산점)",address:"경기 고양시 일산동구 중앙로1261번길 77, 7층 702호 (장항동,한신매트로폴리스)"},
{num:353,name:"바론(본점)",address:"경기 안양시 동안구 엘에스로116번길 91, (호계동) 금정역 3차 SK V1 2층 221호"},
{num:354,name:"화이트(일산점)",address:"경기 고양시 일산동구 중앙로1261번길 77, 7층 702호 (장항동,한신매트로폴리스)"},
{num:355,name:"퓨처스(본점)",address:"서울 마포구 모래내로 5, 202호 (성산동,상암우남퍼스트빌스타)"},
{num:356,name:"아토 본점(본점)",address:"서울 광진구 천호대로 571, 14층 (중곡동) 성우빌딩"},
{num:357,name:"라이즈 본점(본점)",address:"서울 강남구 논현로154길 16, 5층 (신사동,삼륭빌딩)"},
{num:358,name:"대성대리점 개통사무실",address:"대전 서구 청사서로 12 (월평동)"},
{num:359,name:"한민대리점 관저점",address:"대전 서구 관저로 157, 106호 (관저동)"},
{num:360,name:"한올대리점 본점",address:"대전 대덕구 비래동로 20 선진빌딩 1층"},
{num:361,name:"다솔대리점 세종CGV점",address:"세종  도움1로 108. (종촌동)올리브 상가 102호"},
{num:362,name:"다솔대리점 둔산직영점",address:"대전 서구 대덕대로 183 (둔산동,DS클리닉)"},
{num:363,name:"다솔대리점 탄방역점",address:"대전 서구 계룡로536번길 9, 상가동 101호(괴정동,한신아파트)"},
{num:364,name:"티원모바일 홍성서우점",address:"충남 홍성군 홍성읍 법원로 7, ()"},
{num:365,name:"으뜸대리점 오창점",address:"충북 청주시 청원구 오창읍 2산단3로 34, 1층 (경림빌딩) 101호"},
{num:366,name:"으뜸대리점 전민점",address:"대전 유성구 엑스포로 463 (전민동)"},
{num:367,name:"트롤대리점 둔산점",address:"대전 서구 청사로 254, (둔산동,둥지아파트)"},
{num:368,name:"서산동문대리점 예천센트럴점",address:"충남 서산시 예천8로 8, (예천동) 1층 상가 남동향 일부"},
{num:369,name:"서령대리점 당진직영점",address:"충남 당진시 당진중앙2로 42-3 (읍내동,유일빌딩)"},
{num:370,name:"해온대리점 성정사거리점",address:"충남 천안시 서북구 쌍용대로 318 (성정동,명문빌딩)"},
{num:371,name:"해온대리점 두정직영점",address:"충남 천안시 서북구 노태산로 62, (두정동) 다나메디피아 1층"},
{num:372,name:"엠에스커넥트(본점)",address:"충남 천안시 서북구 한들3로 85-85, (백석동)"},
{num:373,name:"맥스대리점 가경TPS점",address:"충북 청주시 흥덕구 서현북로 78 (가경동,사무소)"},
{num:374,name:"흥덕대리점 지웰점",address:"충북 청주시 흥덕구 대농로 58, 103호(복대동,엔젤타워)"},
{num:375,name:"흥덕대리점 오창점",address:"충북 청주시 청원구 오창읍 2산단3로 24 SK텔레콤"},
{num:376,name:"흥덕대리점 제천중앙점",address:"충북 제천시 의림대로 111, (중앙로1가)"},
{num:377,name:"홍익대리점 법인사무실",address:"충북 청주시 서원구 사직대로 160, 1동 204호 (사창동,사창하트리움에덴아파트)"},
{num:378,name:"홍익대리점 분평중앙점",address:"충북 청주시 서원구 분평동 1258번지 1층"},
{num:379,name:"홍익대리점 오창점",address:"충북 청주시 청원구 오창읍 2산단로 138, SK텔레콤"},
{num:380,name:"홍익대리점 다정점",address:"세종  다정중앙로 52, (다정동) 페스티발 Ⅱ 111호"},
{num:381,name:"홍익대리점 오송2산단점",address:"충북 청주시 흥덕구 오송읍 오송생명11로 48, 104호"},
{num:382,name:"미래대리점 본점",address:"충북 제천시 풍양로15길 13, (중앙로2가)"},
{num:383,name:"미래대리점 착한직영점",address:"충북 제천시 풍양로 108 (중앙로1가) 제천중앙시장"},
{num:384,name:"한음대리점 용암점",address:"충북 청주시 상당구 월평로 192, 101호(용암동,대영빌딩)"},
{num:385,name:"애플대리점 법원사거리점",address:"충북 충주시 계명대로 119, 1층 102호(교현동)"},
];

let storeData = {};
let currentStore = null;
let map;
let markers = []; // 마커 저장

// ============================================
// Firebase 함수들
// ============================================

async function loadDataFromFirebase() {
  try {
    const snapshot = await db.collection('stores').get();
    snapshot.forEach(doc => {
      storeData[doc.id] = doc.data();
    });
    console.log('Firebase에서 데이터 로드 완료:', Object.keys(storeData).length + '개');
    updateAllBubbles();
    updateProgress();
  } catch (error) {
    console.error('데이터 로드 실패:', error);
  }
}

async function saveDataToFirebase(storeNum, data) {
  showLoading(true);
  try {
    await db.collection('stores').doc(String(storeNum)).set(data);
    console.log(`매장 ${storeNum} 저장 완료`);
    showLoading(false);
  } catch (error) {
    console.error('저장 실패:', error);
    alert('저장에 실패했습니다. 다시 시도해주세요.');
    showLoading(false);
  }
}

function showLoading(show) {
  document.getElementById('loading').style.display = show ? 'block' : 'none';
}

function updateAllBubbles() {
  Object.keys(storeData).forEach(num => {
    const bubble = document.getElementById(`b-${num}`);
    if (bubble && storeData[num].visited) {
      bubble.classList.add('visited');
    }
  });
}

// ============================================
// 줌 레벨에 따른 라벨 업데이트
// ============================================
function updateMarkerLabels(zoom) {
  markers.forEach(markerObj => {
    const storeNum = markerObj.storeNum;
    const store = stores.find(s => s.num === storeNum);
    const isVisited = storeData[storeNum] && storeData[storeNum].visited ? 'visited' : '';
    
    let content;
    if (zoom >= 13) {
      // 줌 인: 번호 + 이름 표시 (풀 버전)
      content = `
        <div class="bubble-full ${isVisited}" id="b-${storeNum}">
          ${storeNum}. ${store.name}
        </div>
      `;
    } else {
      // 줌 아웃: 번호만 표시 (간소 버전)
      content = `
        <div class="bubble-simple ${isVisited}" id="b-${storeNum}">
          ${storeNum}
        </div>
      `;
    }
    
    let anchorPoint;
if (zoom >= 13) {
  // 텍스트 버전: 기존 위치 유지
  anchorPoint = new naver.maps.Point(50, 40);
} else {
  // 원 버전: 원의 중심
  anchorPoint = new naver.maps.Point(16, 20);
}

markerObj.marker.setIcon({
  content: content,
  anchor: anchorPoint
});
  });
}

// ============================================
// AI 분석 기능
// ============================================

async function analyzeWithAI() {
  document.getElementById('ai-modal').classList.add('show');
  document.getElementById('ai-result').innerHTML = '<div class="ai-loading">AI가 데이터를 분석하고 있습니다</div>';
  
  const analysisData = stores.map(store => {
    const data = storeData[store.num] || {visited: false, comment: ""};
    return {
      번호: store.num,
      이름: store.name,
      주소: store.address,
      방문완료: data.visited ? '완료' : '미방문',
      코멘트: data.comment || '없음'
    };
  });
  
  const total = stores.length;
  const completed = analysisData.filter(s => s.방문완료 === '완료').length;
  
  try {
    const response = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'x-api-key': ANTHROPIC_API_KEY,
        'anthropic-version': '2023-06-01'
      },
      body: JSON.stringify({
        model: 'claude-sonnet-4-20250514',
        max_tokens: 2000,
        messages: [{
          role: 'user',
          content: `다음은 전국 385개 대리점 방문 현황 데이터입니다. 

전체 매장: ${total}개
방문 완료: ${completed}개
미방문: ${total - completed}개

데이터:
${JSON.stringify(analysisData, null, 2)}

이 데이터를 분석하여 다음 내용을 알려주세요:

1. 📊 **지역별 방문 현황**
   - 각 지역(시/도)별 방문 완료율은?
   - 어느 지역이 방문률이 높고 낮은가?

2. 🎯 **우선순위 추천**
   - 다음에 방문해야 할 지역/매장 추천 (지역 클러스터링 고려)

3. 💬 **코멘트 분석**
   - 코멘트가 있는 매장들의 주요 특징
   - 자주 언급되는 키워드나 패턴

4. ✅ **행동 계획**
   - 효율적인 방문 순서 제안

한국어로 친절하고 명확하게 답변해주세요.`
        }]
      })
    });
    
    const result = await response.json();
    
    if (result.content && result.content[0]) {
      const analysis = result.content[0].text;
      document.getElementById('ai-result').innerHTML = `<div style="white-space: pre-wrap; line-height: 1.8;">${analysis}</div>`;
    } else {
      throw new Error('분석 결과를 받지 못했습니다.');
    }
    
  } catch (error) {
    console.error('AI 분석 오류:', error);
    document.getElementById('ai-result').innerHTML = `
      <div style="color: #d32f2f; padding: 20px; text-align: center;">
        <p><strong>⚠️ AI 분석에 실패했습니다</strong></p>
        <p style="font-size: 14px; margin-top: 10px;">
          ${error.message || 'API 키를 확인해주세요.'}
        </p>
      </div>
    `;
  }
}

function closeAIModal() {
  document.getElementById('ai-modal').classList.remove('show');
}

document.getElementById('ai-analyze-btn').addEventListener('click', analyzeWithAI);

// ============================================
// 엑셀 다운로드 기능
// ============================================

function downloadExcel() {
  const excelData = [];
  excelData.push(['넘버', '대리점 이름', '대리점 주소', '완료 여부', '코멘트']);
  
  stores.forEach(store => {
    const data = storeData[store.num] || {visited: false, comment: ""};
    excelData.push([
      store.num,
      store.name,
      store.address,
      data.visited ? '완료' : '미방문',
      data.comment || ''
    ]);
  });
  
  const ws = XLSX.utils.aoa_to_sheet(excelData);
  ws['!cols'] = [
    {wch: 8},
    {wch: 30},
    {wch: 50},
    {wch: 12},
    {wch: 50}
  ];
  
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, '대리점 방문 현황');
  
  const today = new Date();
  const dateStr = `${today.getFullYear()}${String(today.getMonth()+1).padStart(2,'0')}${String(today.getDate()).padStart(2,'0')}`;
  const filename = `대리점_방문현황_${dateStr}.xlsx`;
  
  XLSX.writeFile(wb, filename);
}

document.getElementById('download-btn').addEventListener('click', downloadExcel);

// ============================================
// 기존 함수들
// ============================================

function updateProgress(){
  const total = stores.length;
  const done = Object.values(storeData).filter(v=>v.visited).length;
  const percent = Math.round((done/total)*100);
  document.getElementById("progress").innerText =
    `완료율 ${done}/${total} (${percent}%)`;
}

function openModal(storeNum){
  currentStore = storeNum;
  const store = stores.find(s => s.num === storeNum);
  const data = storeData[storeNum] || {visited: false, comment: ""};
  
  document.getElementById("modal-title").innerHTML = 
    `<div style="margin-bottom: 8px;">${store.num}. ${store.name}</div>
     <div style="font-size: 14px; color: #666; font-weight: normal;">${store.address}</div>`;
  
  document.querySelectorAll(".status-btn").forEach(btn => {
    btn.classList.remove("active");
    if(btn.dataset.status === String(data.visited)){
      btn.classList.add("active");
    }
  });
  
  const textarea = document.getElementById("comment-input");
  textarea.value = data.comment || "";
  updateCharCount();
  
  document.getElementById("modal").classList.add("show");
}

function closeModal(){
  document.getElementById("modal").classList.remove("show");
  currentStore = null;
}

async function saveModal(){
  const visitedBtn = document.querySelector(".status-btn.active");
  const visited = visitedBtn ? visitedBtn.dataset.status === "true" : false;
  const comment = document.getElementById("comment-input").value;
  
  const data = {visited, comment, updatedAt: new Date().toISOString()};
  storeData[currentStore] = data;
  
  await saveDataToFirebase(currentStore, data);
  
  const bubble = document.getElementById(`b-${currentStore}`);
  if(visited){
    bubble.classList.add('visited');
  } else {
    bubble.classList.remove('visited');
  }
  
  updateProgress();
  closeModal();
}

function updateCharCount(){
  const textarea = document.getElementById("comment-input");
  const count = textarea.value.length;
  document.getElementById("char-count").innerText = `${count}/500`;
}

document.querySelector(".modal-btn.cancel").addEventListener('click', closeModal);
document.querySelector(".modal-btn.save").addEventListener('click', saveModal);
document.getElementById("comment-input").addEventListener('input', updateCharCount);

document.querySelectorAll(".status-btn").forEach(btn => {
  btn.addEventListener("click", function(){
    document.querySelectorAll(".status-btn").forEach(b => b.classList.remove("active"));
    this.classList.add("active");
  });
});

document.getElementById("modal").addEventListener("click", function(e){
  if(e.target === this){
    closeModal();
  }
});

// ============================================
// 앱 초기화
// ============================================

async function askChatAI initializeApp() {
  await loadDataFromFirebase();
  
  naver.maps.onJSContentLoaded = function(){
    map = new naver.maps.Map("map", {
      center: new naver.maps.LatLng(36.5, 127.5),
      zoom: 7
    });

    const bounds = new naver.maps.LatLngBounds();

    stores.forEach((store,index)=>{
      if (!storeData[store.num]) {
        storeData[store.num] = {visited: false, comment: ""};
      }

      setTimeout(()=>{
        naver.maps.Service.geocode(
          {query:store.address},
          function(status,res){
            if(status !== naver.maps.Service.Status.OK) return;

            const addr = res.v2.addresses[0];
            const pos = new naver.maps.LatLng(addr.y, addr.x);
            bounds.extend(pos);

            const isVisited = storeData[store.num].visited ? 'visited' : '';
            const currentZoom = map.getZoom();

            let content;
            if (currentZoom >= 13) {
              content = `
                <div class="bubble-full ${isVisited}" id="b-${store.num}">
                  ${store.num}. ${store.name}
                </div>
              `;
            } else {
              content = `
                <div class="bubble-simple ${isVisited}" id="b-${store.num}">
                  ${store.num}
                </div>
              `;
            }

            const marker = new naver.maps.Marker({
              position: pos,
              map: map,
              icon:{
                content: content,
                anchor: new naver.maps.Point(15, 15)
              }
            });

            markers.push({
              marker: marker,
              storeNum: store.num
            });

            naver.maps.Event.addListener(marker,"click",()=>{
              openModal(store.num);
            });

            if(index === stores.length-1){
              map.fitBounds(bounds);
              updateProgress();
            }
          }
        );
      }, index*15);
    });

    // 줌 변경 이벤트 리스너
    naver.maps.Event.addListener(map, 'zoom_changed', function() {
      const zoom = map.getZoom();
      updateMarkerLabels(zoom);
    });
  };
  
if (typeof naver !== 'undefined' && naver.maps) {
    naver.maps.onJSContentLoaded();
  }
}

// 페이지 로드 시 자동 실행
window.addEventListener('DOMContentLoaded', initializeApp);

// ============================================
// ============================================
// AI 에이전트 도구 함수들
// ============================================

// 도구 정의
const aiTools = [
  {
    name: "get_unvisited_stores",
    description: "미방문 매장 목록을 조회합니다. 지역으로 필터링 가능합니다.",
    input_schema: {
      type: "object",
      properties: {
        region: {
          type: "string",
          description: "필터링할 지역 (예: '서울', '강남구', '부산'). 없으면 전체 조회"
        }
      }
    }
  },
  {
    name: "get_visited_stores",
    description: "방문 완료한 매장 목록을 조회합니다.",
    input_schema: {
      type: "object",
      properties: {
        region: {
          type: "string",
          description: "필터링할 지역"
        }
      }
    }
  },
  {
    name: "get_completion_rate",
    description: "지역별 방문 완료율을 계산합니다.",
    input_schema: {
      type: "object",
      properties: {
        region: {
          type: "string",
          description: "조회할 지역. 없으면 전체 조회"
        }
      }
    }
  },
  {
    name: "get_store_info",
    description: "특정 매장의 상세 정보를 조회합니다.",
    input_schema: {
      type: "object",
      properties: {
        store_number: {
          type: "integer",
          description: "조회할 매장 번호"
        }
      },
      required: ["store_number"]
    }
  },
  {
    name: "get_stores_by_region",
    description: "특정 지역의 모든 매장을 조회합니다.",
    input_schema: {
      type: "object",
      properties: {
        region: {
          type: "string",
          description: "조회할 지역"
        }
      },
      required: ["region"]
    }
  },
  {
    name: "plan_route",
    description: "여러 매장을 효율적으로 방문할 수 있는 동선을 계획합니다.",
    input_schema: {
      type: "object",
      properties: {
        store_numbers: {
          type: "array",
          items: { type: "integer" },
          description: "방문할 매장 번호 배열"
        }
      },
      required: ["store_numbers"]
    }
  },
  {
    name: "get_region_statistics",
    description: "전체 지역별 통계를 조회합니다. 시/도별, 구별 분류 가능.",
    input_schema: {
      type: "object",
      properties: {
        level: {
          type: "string",
          enum: ["시도", "구"],
          description: "통계 레벨: '시도'(서울, 부산 등) 또는 '구'(강남구, 해운대구 등)"
        }
      },
      required: ["level"]
    }
  }
];

// 도구 실행 함수
function executeAITool(toolName, toolInput) {
  console.log(`도구 실행: ${toolName}`, toolInput);
  
  switch(toolName) {
    case "get_unvisited_stores":
      return getUnvisitedStores(toolInput.region);
      
    case "get_visited_stores":
      return getVisitedStores(toolInput.region);
      
    case "get_completion_rate":
      return getCompletionRate(toolInput.region);
      
    case "get_store_info":
      return getStoreInfo(toolInput.store_number);
      
    case "get_stores_by_region":
      return getStoresByRegion(toolInput.region);
      
    case "plan_route":
      return planRoute(toolInput.store_numbers);
      
    case "get_region_statistics":
      return getRegionStatistics(toolInput.level);
      
    default:
      return { error: "알 수 없는 도구입니다." };
  }
}

// 1. 미방문 매장 조회
function getUnvisitedStores(region) {
  let filtered = stores.filter(store => {
    const data = storeData[store.num] || { visited: false };
    return !data.visited;
  });
  
  if (region) {
    filtered = filtered.filter(store => store.address.includes(region));
  }
  
  return {
    총개수: filtered.length,
    매장목록: filtered.map(s => ({
      번호: s.num,
      이름: s.name,
      주소: s.address
    }))
  };
}

// 2. 방문 완료 매장 조회
function getVisitedStores(region) {
  let filtered = stores.filter(store => {
    const data = storeData[store.num] || { visited: false };
    return data.visited;
  });
  
  if (region) {
    filtered = filtered.filter(store => store.address.includes(region));
  }
  
  return {
    총개수: filtered.length,
    매장목록: filtered.map(s => ({
      번호: s.num,
      이름: s.name,
      주소: s.address,
      코멘트: storeData[s.num]?.comment || '없음'
    }))
  };
}

// 3. 완료율 계산
function getCompletionRate(region) {
  let filtered = stores;
  
  if (region) {
    filtered = stores.filter(store => store.address.includes(region));
  }
  
  const total = filtered.length;
  const completed = filtered.filter(store => {
    const data = storeData[store.num] || { visited: false };
    return data.visited;
  }).length;
  
  return {
    지역: region || "전체",
    전체매장: total,
    완료매장: completed,
    미방문매장: total - completed,
    완료율: total > 0 ? Math.round((completed / total) * 100) + "%" : "0%"
  };
}

// 4. 매장 정보 조회
function getStoreInfo(storeNumber) {
  const store = stores.find(s => s.num === storeNumber);
  if (!store) return { error: "매장을 찾을 수 없습니다." };
  
  const data = storeData[storeNumber] || { visited: false, comment: "" };
  
  return {
    번호: store.num,
    이름: store.name,
    주소: store.address,
    방문상태: data.visited ? "방문완료" : "미방문",
    코멘트: data.comment || "없음",
    최종수정일: data.updatedAt || "없음"
  };
}

// 5. 지역별 매장 조회
function getStoresByRegion(region) {
  const filtered = stores.filter(store => store.address.includes(region));
  
  const visited = filtered.filter(s => {
    const data = storeData[s.num] || { visited: false };
    return data.visited;
  }).length;
  
  return {
    지역: region,
    전체매장: filtered.length,
    방문완료: visited,
    미방문: filtered.length - visited,
    매장목록: filtered.map(s => ({
      번호: s.num,
      이름: s.name,
      주소: s.address,
      방문완료: storeData[s.num]?.visited ? "완료" : "미방문"
    }))
  };
}

// 6. 동선 계획
function planRoute(storeNumbers) {
  const selectedStores = stores.filter(s => storeNumbers.includes(s.num));
  
  if (selectedStores.length === 0) {
    return { error: "선택된 매장이 없습니다." };
  }
  
  // 지역별로 그룹화
  const grouped = {};
  selectedStores.forEach(store => {
    const parts = store.address.split(' ');
    const region = parts[0] + ' ' + parts[1]; // "서울 강남구"
    if (!grouped[region]) grouped[region] = [];
    grouped[region].push({
      번호: store.num,
      이름: store.name,
      주소: store.address
    });
  });
  
  return {
    총매장수: selectedStores.length,
    지역수: Object.keys(grouped).length,
    지역별그룹: grouped,
    추천동선: "같은 지역 매장들을 먼저 방문하는 것이 효율적입니다."
  };
}

// 7. 지역별 통계
function getRegionStatistics(level) {
  const stats = {};
  
  stores.forEach(store => {
    const parts = store.address.split(' ');
    let key;
    
    if (level === "시도") {
      key = parts[0]; // "서울", "부산" 등
    } else {
      key = parts[0] + ' ' + parts[1]; // "서울 강남구" 등
    }
    
    if (!stats[key]) {
      stats[key] = { 전체: 0, 완료: 0, 미방문: 0 };
    }
    
    stats[key].전체++;
    
    const data = storeData[store.num] || { visited: false };
    if (data.visited) {
      stats[key].완료++;
    } else {
      stats[key].미방문++;
    }
  });
  
  // 완료율 추가
  Object.keys(stats).forEach(key => {
    const s = stats[key];
    s.완료율 = Math.round((s.완료 / s.전체) * 100) + "%";
  });
  
  return {
    통계레벨: level,
    지역수: Object.keys(stats).length,
    지역별통계: stats
  };
}

// ============================================
// AI 채팅 UI 기능
// ============================================

// 채팅창 열기
document.getElementById('open-chat-btn').addEventListener('click', function() {
  document.getElementById('ai-sidebar').classList.add('open');
});

// 채팅창 닫기
document.getElementById('close-sidebar').addEventListener('click', function() {
  document.getElementById('ai-sidebar').classList.remove('open');
});

// 메시지 추가 (테스트용)
function addChatMessage(text, isUser = false) {
  const messagesDiv = document.getElementById('chat-messages');
  
  const messageDiv = document.createElement('div');
  messageDiv.className = `chat-message ${isUser ? 'user' : 'ai'}`;
  
  const bubble = document.createElement('div');
  bubble.className = 'message-bubble';
  bubble.textContent = text;
  
  const time = document.createElement('div');
  time.className = 'message-time';
  const now = new Date();
  time.textContent = `${now.getHours()}:${String(now.getMinutes()).padStart(2, '0')}`;
  
  messageDiv.appendChild(bubble);
  messageDiv.appendChild(time);
  messagesDiv.appendChild(messageDiv);
  
  // 스크롤을 맨 아래로
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}
// ===== 여기에 추가 ===== //

// AI 에이전트에게 질문하기
async function askChatAI(question) {
  // 사용자 메시지 추가
  addChatMessage(question, true);
  
  // 입력창 초기화
  document.getElementById('chat-input').value = '';
  
  // "생각 중..." 메시지 추가
  const thinkingId = 'thinking-' + Date.now();
  const messagesDiv = document.getElementById('chat-messages');
  const thinkingDiv = document.createElement('div');
  thinkingDiv.id = thinkingId;
  thinkingDiv.className = 'chat-message ai';
  thinkingDiv.innerHTML = '<div class="message-bubble">🤔 생각 중...</div>';
  messagesDiv.appendChild(thinkingDiv);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
  
  // 대화 기록
  let messages = [{
    role: 'user',
    content: question
  }];
  
  try {
    // 최대 10번 반복 (AI가 여러 도구를 연속으로 사용할 수 있음)
    for (let i = 0; i < 10; i++) {
      const response = await fetch('https://api.anthropic.com/v1/messages', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'x-api-key': ANTHROPIC_API_KEY,
          'anthropic-version': '2023-06-01'
        },
        body: JSON.stringify({
          model: 'claude-sonnet-4-20250514',
          max_tokens: 2000,
          tools: aiTools,
          messages: messages,
          system: `당신은 대리점 방문 관리를 돕는 AI 에이전트입니다.

현재 전체 ${stores.length}개 매장 중 ${Object.values(storeData).filter(d => d.visited).length}개를 방문 완료했습니다.

사용 가능한 도구를 활용해서 정확한 데이터를 조회하고 분석해주세요.
- 지역 검색 시 정확한 도구를 사용하세요
- 동선 계획 시 지역별로 그룹화하여 제안하세요
- 통계 요청 시 적절한 레벨(시도/구)로 조회하세요

친절하고 구체적으로 답변해주세요.`
        })
      });
      
      const result = await response.json();
      
      console.log('AI 응답:', result);
      
      // 오류 처리
      if (result.error) {
        throw new Error(result.error.message || 'API 오류');
      }
      
      // AI가 최종 답변을 한 경우
      if (result.stop_reason === 'end_turn') {
        document.getElementById(thinkingId)?.remove();
        
        const textContent = result.content.find(c => c.type === 'text');
        if (textContent) {
          addChatMessage(textContent.text, false);
        }
        break;
      }
      
      // AI가 도구를 사용하는 경우
      if (result.stop_reason === 'tool_use') {
        const toolUse = result.content.find(c => c.type === 'tool_use');
        
        if (toolUse) {
          console.log(`도구 사용: ${toolUse.name}`, toolUse.input);
          
          // "생각 중..." 메시지 업데이트
          const thinking = document.getElementById(thinkingId);
          if (thinking) {
            thinking.querySelector('.message-bubble').textContent = 
              `🔧 ${toolUse.name} 실행 중...`;
          }
          
          // 도구 실행
          const toolResult = executeAITool(toolUse.name, toolUse.input);
          console.log('도구 결과:', toolResult);
          
          // 대화 기록에 추가
          messages.push({
            role: 'assistant',
            content: result.content
          });
          
          messages.push({
            role: 'user',
            content: [{
              type: 'tool_result',
              tool_use_id: toolUse.id,
              content: JSON.stringify(toolResult)
            }]
          });
          
          // 다음 반복에서 AI가 도구 결과를 보고 답변
          continue;
        }
      }
      
      // 예상치 못한 상황
      break;
    }
    
  } catch (error) {
    console.error('AI 에이전트 오류:', error);
    document.getElementById(thinkingId)?.remove();
    addChatMessage(`오류가 발생했습니다: ${error.message}\n\nAPI 키를 확인해주세요.`, false);
  }
}

// ===== 여기까지 추가 ===== //


// 전송 버튼 클릭
document.getElementById('send-chat-btn').addEventListener('click', function() {
  const input = document.getElementById('chat-input');
  const message = input.value.trim();
  
  if (message) {
    askChatAI(message);
  }
});

// Enter 키로 전송 (Shift+Enter는 줄바꿈)
document.getElementById('chat-input').addEventListener('keypress', function(e) {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    document.getElementById('send-chat-btn').click();
  }
});

// ========== 여기까지 복사 ==========
</script>

</body>
</html>












