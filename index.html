<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>NCSI 대리점 정밀 지도</title>

  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

  <!-- 네이버 지도 SDK -->
  <script src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=k8vacdhpym&submodules=geocoder"></script>

  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      font-family: "Malgun Gothic", sans-serif;
    }

    #map {
      width: 100vw;
      height: 100vh;
    }

    .loading-bar {
      position: absolute;
      top: 12px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1000;
      background: rgba(255,255,255,0.95);
      padding: 10px 18px;
      border-radius: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,.15);
      font-size: 14px;
    }

    .label {
      background: #fff;
      border: 2px solid #d32f2f;
      border-radius: 6px;
      padding: 3px 8px;
      font-size: 12px;
      font-weight: bold;
      white-space: nowrap;
      box-shadow: 2px 2px 6px rgba(0,0,0,.25);
    }
  </style>
</head>

<body>

<div id="loading" class="loading-bar">
  네이버 지도를 불러오고 주소를 변환 중입니다…
</div>
<div id="map"></div>

<script>
/* ===============================
   1. 대리점 데이터
================================ */
const stores = [
  {num:1, name:"울림터대리점 군자역점", address:"서울 광진구 군자동 477-19"},
  {num:2, name:"다원대리점 중곡직영점", address:"서울 광진구 긴고랑로 115"},
  {num:3, name:"광장대리점 중곡점", address:"서울 광진구 면목로 160"},
  {num:4, name:"울림터대리점 본점", address:"서울 광진구 아차산로 220"},
  {num:5, name:"광장대리점 구의점", address:"서울 광진구 아차산로 415"},
  {num:6, name:"PS&M 강변역점", address:"서울 광진구 광나루로56길 85"},
  {num:7, name:"PS&M 강변역2호점", address:"서울 광진구 광나루로56길 85"},
  {num:8, name:"광장대리점 광장점", address:"서울 광진구 광나루로 590"},
  {num:9, name:"다원대리점 구의본점", address:"서울 광진구 자양로 116"},
  {num:10, name:"광장대리점 자양점", address:"서울 광진구 자양로 50"},
  {num:11, name:"PS&M 건대입구역점", address:"서울 광진구 아차산로 229"},
  {num:12, name:"동진대리점 화양점", address:"서울 광진구 아차산로 201"},
  {num:13, name:"성진대리점 건대점", address:"서울 광진구 동일로20길 113"},
  {num:14, name:"다원대리점 건대점", address:"서울 광진구 능동로 135-1"},
  {num:15, name:"PS&M 군자역점", address:"서울 광진구 천호대로 549"},
  {num:16, name:"동진대리점 중곡역점", address:"서울 광진구 능동로 394"},
  {num:17, name:"참스타대리점 중곡본점", address:"서울 광진구 능동로 346"},
  {num:18, name:"다원대리점 중곡본점", address:"서울 광진구 면목로 151"},
  {num:19, name:"울림터대리점 능동점", address:"서울 광진구 천호대로 522"},
  {num:20, name:"PS&M 어린이대공원역점", address:"서울 광진구 능동로 189"},
  {num:21, name:"광장대리점 성수점", address:"서울 성동구 아차산로 110"},
  {num:22, name:"PS&M 성수점", address:"서울 성동구 아차산로 103"},
  {num:23, name:"동진대리점 뚝섬역점", address:"서울 성동구 상원길 15"},
  {num:24, name:"다원대리점 성수본점", address:"서울 성동구 아차산로 51-1"},
  {num:25, name:"PS&M 한양대점", address:"서울 성동구 사근동길 2"},
  {num:26, name:"동진대리점 왕십리역점", address:"서울 성동구 왕십리로 321"},
  {num:27, name:"다원대리점 왕십리점", address:"서울 성동구 왕십리로 323"},
  {num:28, name:"동진대리점 상왕십리역점", address:"서울 성동구 왕십리로 368"},
  {num:29, name:"PS&M 화곡역점", address:"서울 강서구 화곡로 161"},
  {num:30, name:"동진대리점 화곡역본점", address:"서울 강서구 화곡로 162"},
  {num:31, name:"동진대리점 가양역본점", address:"서울 강서구 화곡로68길 3"},
  {num:32, name:"PS&M 등촌역점", address:"서울 양천구 공항대로 564"},
  {num:33, name:"강서대리점 신월본점", address:"서울 양천구 남부순환로 354"},
  {num:34, name:"참스타대리점 신월점", address:"서울 양천구 남부순환로 585"},
  {num:35, name:"동진대리점 신월점", address:"서울 양천구 남부순환로 571"},
  {num:36, name:"PS&M 신정네거리역점", address:"서울 양천구 중앙로 250"},
  {num:37, name:"강서대리점 신정점", address:"서울 양천구 신정로 312"},
  {num:38, name:"참스타대리점 신정본점", address:"서울 양천구 중앙로 225"},
  {num:39, name:"동진대리점 목동역점", address:"서울 양천구 오목로 230"},
  {num:40, name:"PS&M 목동역점", address:"서울 양천구 오목로 231"},
  {num:41, name:"PS&M 오목교역점", address:"서울 양천구 오목로 331"}
];

/* ===============================
   2. 네이버 지도 초기화 (중요)
================================ */
naver.maps.onJSContentLoaded = function () {

  const map = new naver.maps.Map("map", {
    center: new naver.maps.LatLng(37.55, 126.97),
    zoom: 12
  });

  const bounds = new naver.maps.LatLngBounds();
  let done = 0;

  /* ===============================
     3. 주소 → 좌표 변환
  ================================ */
  stores.forEach((store, index) => {
    setTimeout(() => {
      naver.maps.Service.geocode(
        { query: store.address },
        function (status, response) {

          if (
            status === naver.maps.Service.Status.OK &&
            response.v2 &&
            response.v2.addresses &&
            response.v2.addresses.length > 0
          ) {
            const addr = response.v2.addresses[0];

            const position = new naver.maps.LatLng(
              parseFloat(addr.y),
              parseFloat(addr.x)
            );

            bounds.extend(position);

            const marker = new naver.maps.Marker({
              position,
              map
            });

            new naver.maps.CustomOverlay({
              position,
              map,
              yAnchor: 2.3,
              content: `<div class="label">${store.num}. ${store.name}</div>`
            });

            const info = new naver.maps.InfoWindow({
              content: `
                <div style="padding:10px; line-height:1.6;">
                  <b>${store.num}. ${store.name}</b><br/>
                  ${store.address}
                </div>`
            });

            naver.maps.Event.addListener(marker, "click", () => {
              info.open(map, marker);
            });
          }

          done++;
          if (done === stores.length) {
            map.fitBounds(bounds);
            document.getElementById("loading").style.display = "none";
          }
        }
      );
    }, index * 80);
  });
};
</script>

</body>
</html>
